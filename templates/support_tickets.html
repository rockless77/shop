{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-ticket-detailed me-2"></i>My Support Tickets</h2>
        <a href="{{ url_for('support') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle me-1"></i> New Ticket
        </a>
    </div>
    
    {% if tickets %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="table-light">
                    <tr>
                        <th>Ticket #</th>
                        <th>Subject</th>
                        <th>Status</th>
                        <th>Priority</th>
                        <th>Created</th>
                        <th>Last Updated</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ticket in tickets %}
                    <tr>
                        <td>#{{ ticket.id }}</td>
                        <td>
                            <a href="{{ url_for('view_ticket', ticket_id=ticket.id) }}" class="text-decoration-none">
                                {{ ticket.subject|truncate(50) }}
                            </a>
                        </td>
                        <td>
                            {% if ticket.status == 'open' %}
                                <span class="badge bg-info">Open</span>
                            {% elif ticket.status == 'in_progress' %}
                                <span class="badge bg-primary">In Progress</span>
                            {% elif ticket.status == 'waiting_for_response' %}
                                <span class="badge bg-warning text-dark">Waiting for Response</span>
                            {% elif ticket.status == 'resolved' %}
                                <span class="badge bg-success">Resolved</span>
                            {% elif ticket.status == 'closed' %}
                                <span class="badge bg-secondary">Closed</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if ticket.priority == 'low' %}
                                <span class="badge bg-light text-dark">Low</span>
                            {% elif ticket.priority == 'medium' %}
                                <span class="badge bg-primary">Medium</span>
                            {% elif ticket.priority == 'high' %}
                                <span class="badge bg-warning text-dark">High</span>
                            {% elif ticket.priority == 'critical' %}
                                <span class="badge bg-danger">Critical</span>
                            {% endif %}
                        </td>
                        <td>{{ ticket.created_at.strftime('%b %d, %Y %H:%M') }}</td>
                        <td>{{ ticket.updated_at.strftime('%b %d, %Y %H:%M') }}</td>
                        <td>
                            <a href="{{ url_for('view_ticket', ticket_id=ticket.id) }}" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-eye"></i> View
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i> 
            You haven't created any support tickets yet. 
            <a href="{{ url_for('support') }}" class="alert-link">Create your first ticket</a>.
        </div>
    {% endif %}
    
    <div class="card mt-4">
        <div class="card-body">
            <h5 class="card-title">Support Information</h5>
            <p class="card-text">
                <strong>Email:</strong> support@shopeasy.com<br>
                <strong>Phone:</strong> +1 (555) 123-4567<br>
                <strong>Hours:</strong> Monday - Friday, 9:00 AM - 6:00 PM (EST)
            </p>
            <p class="card-text">
                For immediate assistance, please check our <a href="#" class="text-decoration-none">Help Center</a> 
                for answers to common questions.
            </p>
        </div>
    </div>
</div>
{% endblock %}
